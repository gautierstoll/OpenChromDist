\doxysection{Peak\+Based\+Dist.\+h}
\hypertarget{PeakBasedDist_8h_source}{}\label{PeakBasedDist_8h_source}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Created\ by\ gstoll\ on\ 18/06/25.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#ifndef\ PEAKBASEDDIST\_H}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#define\ PEAKBASEDDIST\_H}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <optional>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <unordered\_set>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classPeakBasedDist}{PeakBasedDist}}\ \{\ \textcolor{comment}{//many\ cells,\ a\ unique\ chromosome}}
\DoxyCodeLine{00023\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ \mbox{\hyperlink{classPeakBasedDist_a30922e4246010d34213202b1f60b9f60}{chromosome}};\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{classPeakBasedDist_a4028fe05cac1967ebd39768c6517e9df}{chrLength}};\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{classPeakBasedDist_a6055b04ce2c49fd846ee1eb8c907db96}{bpStep}};\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{classPeakBasedDist_a31f64c59a6af28e043f8642c5170dd5b}{windSize}};\ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keyword}{const}\ std::unordered\_set<std::string>\&\ \mbox{\hyperlink{classPeakBasedDist_a83c463bd06ce459370587399ef1ed3dd}{barCodesSet}};\ }
\DoxyCodeLine{00029\ \ \ \ \ std::unordered\_map<std::string,std::vector<double>>\ \mbox{\hyperlink{classPeakBasedDist_af7af03f129d5fdabd0f108229ae1674f}{cumulUnnormProb}};\ }
\DoxyCodeLine{00030\ \ \ \ \ std::unordered\_map<std::string,double>\ \mbox{\hyperlink{classPeakBasedDist_a7055cf566bac3c995d4cf9dfea0dd446}{normFactor}};\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classPeakBasedDist_a9e56d3c0e4297a4c1f776c3427702fd0}{PeakBasedDist}}(std::string\ \&\ \mbox{\hyperlink{classPeakBasedDist_a30922e4246010d34213202b1f60b9f60}{chromosome}},\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{classPeakBasedDist_a4028fe05cac1967ebd39768c6517e9df}{chrLength}},\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{classPeakBasedDist_a6055b04ce2c49fd846ee1eb8c907db96}{bpStep}},\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{classPeakBasedDist_a31f64c59a6af28e043f8642c5170dd5b}{windSize}},\ \textcolor{keyword}{const}\ std::unordered\_set<std::string>\ \&\ barCodeSet)\ :}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{classPeakBasedDist_a30922e4246010d34213202b1f60b9f60}{chromosome}}(\mbox{\hyperlink{classPeakBasedDist_a30922e4246010d34213202b1f60b9f60}{chromosome}}),\ \mbox{\hyperlink{classPeakBasedDist_a4028fe05cac1967ebd39768c6517e9df}{chrLength}}(\mbox{\hyperlink{classPeakBasedDist_a4028fe05cac1967ebd39768c6517e9df}{chrLength}}),\mbox{\hyperlink{classPeakBasedDist_a6055b04ce2c49fd846ee1eb8c907db96}{bpStep}}(\mbox{\hyperlink{classPeakBasedDist_a6055b04ce2c49fd846ee1eb8c907db96}{bpStep}}),\mbox{\hyperlink{classPeakBasedDist_a31f64c59a6af28e043f8642c5170dd5b}{windSize}}(\mbox{\hyperlink{classPeakBasedDist_a31f64c59a6af28e043f8642c5170dd5b}{windSize}}),\mbox{\hyperlink{classPeakBasedDist_a83c463bd06ce459370587399ef1ed3dd}{barCodesSet}}(\mbox{\hyperlink{classPeakBasedDist_a83c463bd06ce459370587399ef1ed3dd}{barCodesSet}})\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ std::string\ \&\ barCode\ :\ \mbox{\hyperlink{classPeakBasedDist_a83c463bd06ce459370587399ef1ed3dd}{barCodesSet}})\ \{\ \mbox{\hyperlink{classPeakBasedDist_af7af03f129d5fdabd0f108229ae1674f}{cumulUnnormProb}}[barCode]=\ std::vector<double>((\mbox{\hyperlink{classPeakBasedDist_a4028fe05cac1967ebd39768c6517e9df}{chrLength}}/\mbox{\hyperlink{classPeakBasedDist_a6055b04ce2c49fd846ee1eb8c907db96}{bpStep}}+1),0);}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPeakBasedDist_a7055cf566bac3c995d4cf9dfea0dd446}{normFactor}}[barCode]\ =\ NAN;\ \};}
\DoxyCodeLine{00043\ \ \ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classPeakBasedDist}{PeakBasedDist}}\ \mbox{\hyperlink{classPeakBasedDist_a0efb006b7e56aca1adfd6bb8e58d14ab}{fromBinFile}}(\textcolor{keyword}{const}\ std::string\ \&);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classPeakBasedDist}{PeakBasedDist}}\ \mbox{\hyperlink{classPeakBasedDist_acce1090b92329aa9d4f6bc94ed850ddb}{fromFlatFile}}(\textcolor{keyword}{const}\ std::string\ \&\ chrFile,\textcolor{keyword}{const}\ std::string\ \&barCodeFile);}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPeakBasedDist_ad9732e92a350cc82f469f8612efc6657}{addPeak}}(\textcolor{keyword}{const}\ std::string\ \&\ cellBarCode,\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ position,\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ count,\ std::optional<unsigned\ long>\ windEval);}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPeakBasedDist_ab1cbb045f227193a6eeb6b2ce9bf7f9b}{addPeaksFromFragFile}}(\textcolor{keyword}{const}\ std::string\ \&\ fragFile\ ,\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \&\ windEval);}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPeakBasedDist_a8b7492cccd20f870de35ce82e8fc918e}{chrNormalize}}()\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ std::string\ \&\ barCode\ :\ \mbox{\hyperlink{classPeakBasedDist_a83c463bd06ce459370587399ef1ed3dd}{barCodesSet}})\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPeakBasedDist_a7055cf566bac3c995d4cf9dfea0dd446}{normFactor}}[barCode]\ =\ 1.0/((this-\/>\mbox{\hyperlink{classPeakBasedDist_af7af03f129d5fdabd0f108229ae1674f}{cumulUnnormProb}})[barCode].back());}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00087\ \ \ \ \ \};}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPeakBasedDist_afda6689abc313f42024e1814d3b8c424}{write2BinaryFile}}(\textcolor{keyword}{const}\ std::string\ \&\ binFile);}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ strToUnsLong(\textcolor{keyword}{const}\ std::string\ \&);}
\DoxyCodeLine{00098\ \};}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//PEAKBASEDDIST\_H}}

\end{DoxyCode}
